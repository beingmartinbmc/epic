(function(){const p=document.createElement("link").relList;if(p&&p.supports&&p.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))w(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&w(u)}).observe(document,{childList:!0,subtree:!0});function b(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function w(n){if(n.ep)return;n.ep=!0;const a=b(n);fetch(n.href,a)}})();const Q="modulepreload",Y=function(I,p){return new URL(I,p).href},j={},k=function(p,b,w){let n=Promise.resolve();if(b&&b.length>0){const u=document.getElementsByTagName("link"),i=document.querySelector("meta[property=csp-nonce]"),T=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));n=Promise.allSettled(b.map(d=>{if(d=Y(d,w),d in j)return;j[d]=!0;const C=d.endsWith(".css"),B=C?'[rel="stylesheet"]':"";if(!!w)for(let A=u.length-1;A>=0;A--){const S=u[A];if(S.href===d&&(!C||S.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${d}"]${B}`))return;const g=document.createElement("link");if(g.rel=C?"stylesheet":Q,C||(g.as="script"),g.crossOrigin="",g.href=d,T&&g.setAttribute("nonce",T),document.head.appendChild(g),C)return new Promise((A,S)=>{g.addEventListener("load",A),g.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(u){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=u,window.dispatchEvent(i),!i.defaultPrevented)throw u}return n.then(u=>{for(const i of u||[])i.status==="rejected"&&a(i.reason);return p().catch(a)})};window.addEventListener("DOMContentLoaded",async()=>{const I={OPENAI_PROXY_URL:"https://religious-guide-6ee2nijgx-beingmartinbmcs-projects.vercel.app/api/openai-proxy"},p=await k(()=>import("./prompts-B41tga3v.js"),[],import.meta.url),b=await k(()=>import("./utils-Cs79R1rv.js"),[],import.meta.url),w=await k(()=>import("./cache-Dum-7X9a.js"),[],import.meta.url),n=p.default,{getReferenceUrl:a,parseSource:u}=b,{findCachedResponse:i,cacheResponse:T,clearCache:d,getCacheStats:C}=w;function B(e){if(!e||e.trim().length===0)return{language:"en",confidence:0};const o=e.toLowerCase();return/[\u0900-\u097F]/.test(e)?{language:"hi",confidence:.9}:/[\u0600-\u06FF]/.test(e)?{language:"ar",confidence:.9}:/[\u4E00-\u9FFF]/.test(e)?{language:"zh",confidence:.9}:/[\u3040-\u309F\u30A0-\u30FF]/.test(e)?{language:"ja",confidence:.9}:/[\uAC00-\uD7AF]/.test(e)?{language:"ko",confidence:.9}:/[\u0E00-\u0E7F]/.test(e)?{language:"th",confidence:.9}:/[\u0400-\u04FF]/.test(e)?{language:"ru",confidence:.9}:/[\u0370-\u03FF]/.test(e)?{language:"el",confidence:.9}:/[\u0590-\u05FF]/.test(e)?{language:"he",confidence:.9}:["hola","gracias","por favor","buenos días","buenas noches","adiós","sí","no","me","te","se","que","de","la","el","un","una","y","o","pero","como","cuando","donde","quien","que","cual","cuyo","cuyas","cuyos","cuyas"].filter(h=>new RegExp(`\\b${h}\\b`,"i").test(o)).length>=2?{language:"es",confidence:.8}:["bonjour","merci","s'il vous plaît","au revoir","oui","non","je","tu","il","elle","nous","vous","ils","elles","le","la","les","un","une","des","et","ou","mais","comme","quand","où","qui","que","quoi","dont","duquel","de laquelle"].filter(h=>new RegExp(`\\b${h}\\b`,"i").test(o)).length>=2?{language:"fr",confidence:.8}:["hallo","danke","bitte","auf wiedersehen","ja","nein","ich","du","er","sie","es","wir","ihr","sie","der","die","das","ein","eine","und","oder","aber","wie","wann","wo","wer","was","welcher","welche","welches"].filter(h=>new RegExp(`\\b${h}\\b`,"i").test(o)).length>=2?{language:"de",confidence:.8}:["ciao","grazie","prego","arrivederci","sì","no","io","tu","lui","lei","noi","voi","loro","il","la","lo","gli","le","un","una","e","o","ma","come","quando","dove","chi","che","cosa","quale"].filter(h=>new RegExp(`\\b${h}\\b`,"i").test(o)).length>=2?{language:"it",confidence:.8}:["olá","obrigado","por favor","adeus","sim","não","eu","tu","ele","ela","nós","vós","eles","elas","um","uma","e","ou","mas","como","quando","onde","quem","que","o que","qual"].filter(h=>new RegExp(`\\b${h}\\b`,"i").test(o)).length>=2?{language:"pt",confidence:.8}:["hallo","dank je","alsjeblieft","tot ziens","ja","nee","ik","jij","hij","zij","het","wij","jullie","zij","de","het","een","en","of","maar","hoe","wanneer","waar","wie","wat","welke"].filter(h=>new RegExp(`\\b${h}\\b`,"i").test(o)).length>=2?{language:"nl",confidence:.8}:{language:"en",confidence:.5}}const P={BHAGAVAD_GITA:"theme-hindu",VEDAS:"theme-hindu",QURAN:"theme-islamic",BIBLE:"theme-christian",GURU_GRANTH_SAHIB:"theme-sikh",ALL:"theme-universal"},g={BHAGAVAD_GITA:n.userPrompts.bhagavadGita,VEDAS:n.userPrompts.vedas,QURAN:n.userPrompts.quran,BIBLE:n.userPrompts.bible,GURU_GRANTH_SAHIB:n.userPrompts.guruGranthSahib,ALL:n.userPrompts.allTexts},A=document.getElementById("guidanceForm"),S=document.getElementById("loadingSpinner"),q=document.getElementById("errorMessage"),G=document.getElementById("quotesSection"),H=document.getElementById("quotesGrid"),N=document.getElementById("summarySection"),F=document.getElementById("summaryText"),U=document.getElementById("selectedText"),O=document.querySelector(".divine-container"),v={count:document.getElementById("cacheCount"),validEntries:document.getElementById("validEntries"),latestCache:document.getElementById("latestCache"),clearBtn:document.getElementById("clearCacheBtn")};function x(){const e=C();v.count&&(v.count.textContent=e.validEntries),v.validEntries&&(v.validEntries.textContent=e.validEntries),v.latestCache&&(v.latestCache.textContent=e.newestEntry?new Date(e.newestEntry).toLocaleTimeString():"No entries")}x(),v.clearBtn&&v.clearBtn.addEventListener("click",e=>{e.stopPropagation(),d(),x()}),setInterval(x,6e4),U.addEventListener("change",e=>{Object.values(P).forEach(c=>O.classList.remove(c));const o=P[e.target.value]||"theme-universal";O.classList.add(o),W(e.target.value)});function W(e){const o=document.querySelector(".divine-title i"),c=document.querySelector(".divine-title span"),m=document.querySelector(".divine-subtitle");let t="fas fa-om",r="Divine Wisdom",s="Sacred guidance from ancient texts";switch(e){case"BHAGAVAD_GITA":t="fas fa-om",r="Hindu Wisdom",s="Sacred guidance from the Bhagavad Gita";break;case"VEDAS":t="fas fa-om",r="Hindu Wisdom",s="Sacred guidance from the Vedas";break;case"QURAN":t="fas fa-star-and-crescent",r="Islamic Guidance",s="Blessed guidance from the Holy Quran";break;case"BIBLE":t="fas fa-cross",r="Christian Wisdom",s="Sacred wisdom from the Holy Bible";break;case"GURU_GRANTH_SAHIB":t="fas fa-khanda",r="Sikh Wisdom",s="Divine wisdom from the Guru Granth Sahib";break}o.className=t,c.textContent=r,m.textContent=s}A.addEventListener("submit",async e=>{e.preventDefault();const o=document.getElementById("userMessage").value.trim(),c=document.getElementById("selectedText").value;if(o.split(/\s+/).filter(t=>t.length>0).length<5){$("Please type more details. Share at least 5 words about your situation so I can provide meaningful guidance.");return}S.style.display="block",q.style.display="none",G.style.display="none",N.style.display="none";try{let t=i(c,o),r=!!t;t||(t=await D(o,c),x()),V(t,r)}catch(t){$(t.message)}finally{S.style.display="none"}});async function D(e,o){var _;const c=g[o]||n.userPrompts.allTexts,m={hi:"Hindi",es:"Spanish",fr:"French",de:"German",ar:"Arabic",bn:"Bengali",pa:"Punjabi",gu:"Gujarati",mr:"Marathi",te:"Telugu",ta:"Tamil",ur:"Urdu",pt:"Portuguese",it:"Italian",ja:"Japanese",ko:"Korean",ru:"Russian",tr:"Turkish",zh:"Chinese","zh-CN":"Chinese","zh-TW":"Chinese","zh-HK":"Chinese",nl:"Dutch",sv:"Swedish",da:"Danish",no:"Norwegian",fi:"Finnish",pl:"Polish",cs:"Czech",sk:"Slovak",hu:"Hungarian",ro:"Romanian",bg:"Bulgarian",hr:"Croatian",sr:"Serbian",sl:"Slovenian",et:"Estonian",lv:"Latvian",lt:"Lithuanian",mt:"Maltese",el:"Greek",he:"Hebrew",th:"Thai",vi:"Vietnamese",id:"Indonesian",ms:"Malay",fil:"Filipino",sw:"Swahili",am:"Amharic",ha:"Hausa",yo:"Yoruba",ig:"Igbo",ne:"Nepali",si:"Sinhala",my:"Burmese",km:"Khmer",lo:"Lao"},t=B(e),r=t.language,s=t.confidence;console.log("Language detection:",{detectedLanguage:r,confidence:s,userMessage:e});let E="CRITICAL: You MUST respond in ENGLISH ONLY. All quotes, context, and summary must be in English.";if(r!=="und"&&r!=="en"&&s>.3){const l=m[r];l&&(E=`CRITICAL: Respond in ${l} ONLY. The user wrote in ${l}, so provide your ENTIRE response (quotes, context, and summary) in ${l}. TRANSLATE THE QUOTES INTO ${l} - do not keep quotes in English.`)}console.log("Language instruction:",E);const L=`${c}

User's situation: ${e}`,y=await fetch(I.OPENAI_PROXY_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:[{role:"system",content:`${n.system.prompt}

${E}`},{role:"user",content:L}]})});if(!y.ok){const l=await y.json().catch(()=>({}));throw new Error(((_=l.error)==null?void 0:_.message)||n.errors.serviceUnavailable)}const f=M(await y.json());return f.quotes&&f.quotes.length>0&&f.quotes.every(l=>l.text&&l.source&&l.translation)&&f.summary&&T(e,o,f),f}function M(e){try{const o=e.choices[0].message.content,c=[],m=o.split(`
`);let t=null,r="";for(let s of m)s=s.trim(),s&&(s.startsWith("QUOTE:")?(t&&c.push(t),t={text:s.substring(6).trim(),source:"",translation:""}):s.startsWith("SOURCE:")&&t?t.source=s.substring(7).trim():s.startsWith("CONTEXT:")&&t?t.translation=s.substring(8).trim():s.startsWith("SUMMARY:")&&(r=s.substring(8).trim()));return t&&c.push(t),r||(r=n.fallbackSummaries.default),{quotes:c,summary:r}}catch(o){throw console.error("Error parsing response:",o),new Error(n.errors.noResponse)}}function V(e,o=!1){H.innerHTML=e.quotes.map(c=>{const{source:m,text:t,translation:r}=c,{bookName:s,chapter:E,verse:L}=u(m);let y;s.toLowerCase().includes("guru granth sahib")||s.toLowerCase().includes("granth")?y=`Ang ${E}`:["rigveda","yajurveda","samaveda","atharvaveda"].includes(s.toLowerCase())?y=`${E}.${L}`:y=`${E}:${L}`;const f=a(s,y);return`
        <div class="quote-card">
          <div class="quote-text">${t}</div>
          <div class="quote-source">
            <i class="fas fa-book"></i>
            ${f?`<a href="${f}" target="_blank" rel="noopener noreferrer">${m}</a>`:m}
          </div>
          ${r?`
            <div class="quote-context">
              <span class="context-label">Context</span>
              <div class="context-text">${r}</div>
            </div>`:""}
        </div>
      `}).join(""),F.textContent=e.summary,G.style.display="block",N.style.display="block"}function $(e){q.textContent=e,q.style.display="block"}document.getElementById("userMessage").addEventListener("input",function(){this.style.height="auto",this.style.height=Math.min(this.scrollHeight,200)+"px"})});
