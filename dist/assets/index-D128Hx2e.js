(function(){const y=document.createElement("link").relList;if(y&&y.supports&&y.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))C(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&C(c)}).observe(document,{childList:!0,subtree:!0});function w(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function C(a){if(a.ep)return;a.ep=!0;const s=w(a);fetch(a.href,s)}})();const K="modulepreload",Y=function(T,y){return new URL(T,y).href},U={},B=function(y,w,C){let a=Promise.resolve();if(w&&w.length>0){const c=document.getElementsByTagName("link"),u=document.querySelector("meta[property=csp-nonce]"),P=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));a=Promise.allSettled(w.map(h=>{if(h=Y(h,C),h in U)return;U[h]=!0;const E=h.endsWith(".css"),q=E?'[rel="stylesheet"]':"";if(!!C)for(let A=c.length-1;A>=0;A--){const I=c[A];if(I.href===h&&(!E||I.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${h}"]${q}`))return;const g=document.createElement("link");if(g.rel=E?"stylesheet":K,E||(g.as="script"),g.crossOrigin="",g.href=h,P&&g.setAttribute("nonce",P),document.head.appendChild(g),E)return new Promise((A,I)=>{g.addEventListener("load",A),g.addEventListener("error",()=>I(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(c){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=c,window.dispatchEvent(u),!u.defaultPrevented)throw c}return a.then(c=>{for(const u of c||[])u.status==="rejected"&&s(u.reason);return y().catch(s)})};window.addEventListener("DOMContentLoaded",async()=>{const T={OPENAI_PROXY_URL:"https://religious-guide-hrv0qci1p-beingmartinbmcs-projects.vercel.app/api/openai-proxy"},y=await B(()=>import("./prompts-Bllmj0Gr.js"),[],import.meta.url),w=await B(()=>import("./utils-BIDl2gH2.js"),[],import.meta.url),C=await B(()=>import("./cache-COrhOpB8.js"),[],import.meta.url),a=await B(()=>import("./journal-ui-BchGlns8.js"),[],import.meta.url),s=y.default,{getReferenceUrl:c,parseSource:u}=w,{findCachedResponse:P,cacheResponse:h,clearCache:E,getCacheStats:q}=C;new a.default;function G(e){if(!e||e.trim().length===0)return{language:"en",confidence:0};const o=e.toLowerCase();return/[\u0900-\u097F]/.test(e)?{language:"hi",confidence:.9}:/[\u0600-\u06FF]/.test(e)?{language:"ar",confidence:.9}:/[\u4E00-\u9FFF]/.test(e)?{language:"zh",confidence:.9}:/[\u3040-\u309F\u30A0-\u30FF]/.test(e)?{language:"ja",confidence:.9}:/[\uAC00-\uD7AF]/.test(e)?{language:"ko",confidence:.9}:/[\u0E00-\u0E7F]/.test(e)?{language:"th",confidence:.9}:/[\u0400-\u04FF]/.test(e)?{language:"ru",confidence:.9}:/[\u0370-\u03FF]/.test(e)?{language:"el",confidence:.9}:/[\u0590-\u05FF]/.test(e)?{language:"he",confidence:.9}:["hola","gracias","por favor","buenos días","buenas noches","adiós","sí","no","me","te","se","que","de","la","el","un","una","y","o","pero","como","cuando","donde","quien","que","cual","cuyo","cuyas","cuyos","cuyas"].filter(p=>new RegExp(`\\b${p}\\b`,"i").test(o)).length>=2?{language:"es",confidence:.8}:["bonjour","merci","s'il vous plaît","au revoir","oui","non","je","tu","il","elle","nous","vous","ils","elles","le","la","les","un","une","des","et","ou","mais","comme","quand","où","qui","que","quoi","dont","duquel","de laquelle"].filter(p=>new RegExp(`\\b${p}\\b`,"i").test(o)).length>=2?{language:"fr",confidence:.8}:["hallo","danke","bitte","auf wiedersehen","ja","nein","ich","du","er","sie","es","wir","ihr","sie","der","die","das","ein","eine","und","oder","aber","wie","wann","wo","wer","was","welcher","welche","welches"].filter(p=>new RegExp(`\\b${p}\\b`,"i").test(o)).length>=2?{language:"de",confidence:.8}:["ciao","grazie","prego","arrivederci","sì","no","io","tu","lui","lei","noi","voi","loro","il","la","lo","gli","le","un","una","e","o","ma","come","quando","dove","chi","che","cosa","quale"].filter(p=>new RegExp(`\\b${p}\\b`,"i").test(o)).length>=2?{language:"it",confidence:.8}:["olá","obrigado","por favor","adeus","sim","não","eu","tu","ele","ela","nós","vós","eles","elas","um","uma","e","ou","mas","como","quando","onde","quem","que","o que","qual"].filter(p=>new RegExp(`\\b${p}\\b`,"i").test(o)).length>=2?{language:"pt",confidence:.8}:["hallo","dank je","alsjeblieft","tot ziens","ja","nee","ik","jij","hij","zij","het","wij","jullie","zij","de","het","een","en","of","maar","hoe","wanneer","waar","wie","wat","welke"].filter(p=>new RegExp(`\\b${p}\\b`,"i").test(o)).length>=2?{language:"nl",confidence:.8}:{language:"en",confidence:.5}}const g={BHAGAVAD_GITA:"theme-hindu",VEDAS:"theme-hindu",QURAN:"theme-islamic",BIBLE:"theme-christian",GURU_GRANTH_SAHIB:"theme-sikh",TRIPITAKA:"theme-buddhist",ALL:"theme-universal"},A={BHAGAVAD_GITA:s.userPrompts.bhagavadGita,VEDAS:s.userPrompts.vedas,QURAN:s.userPrompts.quran,BIBLE:s.userPrompts.bible,GURU_GRANTH_SAHIB:s.userPrompts.guruGranthSahib,TRIPITAKA:s.userPrompts.tripitaka,ALL:s.userPrompts.allTexts},I=document.getElementById("guidanceForm"),k=document.getElementById("loadingSpinner"),x=document.getElementById("errorMessage"),N=document.getElementById("quotesSection"),W=document.getElementById("quotesGrid"),O=document.getElementById("summarySection"),F=document.getElementById("summaryText"),D=document.getElementById("selectedText"),$=document.querySelector(".divine-container"),b={count:document.getElementById("cacheCount"),validEntries:document.getElementById("validEntries"),latestCache:document.getElementById("latestCache"),clearBtn:document.getElementById("clearCacheBtn")};function L(){const e=q();b.count&&(b.count.textContent=e.validEntries),b.validEntries&&(b.validEntries.textContent=e.validEntries),b.latestCache&&(b.latestCache.textContent=e.newestEntry?new Date(e.newestEntry).toLocaleTimeString():"No entries")}L(),b.clearBtn&&b.clearBtn.addEventListener("click",e=>{e.stopPropagation(),E(),L()}),setInterval(L,6e4),D.addEventListener("change",e=>{Object.values(g).forEach(i=>$.classList.remove(i));const o=g[e.target.value]||"theme-universal";$.classList.add(o),M(e.target.value)});function M(e){const o=document.querySelector(".divine-title i"),i=document.querySelector(".divine-title span"),f=document.querySelector(".divine-subtitle");let t="fas fa-om",r="Divine Wisdom",n="Sacred guidance from ancient texts";switch(e){case"BHAGAVAD_GITA":t="fas fa-om",r="Hindu Wisdom",n="Sacred guidance from the Bhagavad Gita";break;case"VEDAS":t="fas fa-om",r="Hindu Wisdom",n="Sacred guidance from the Vedas";break;case"QURAN":t="fas fa-star-and-crescent",r="Islamic Guidance",n="Blessed guidance from the Holy Quran";break;case"BIBLE":t="fas fa-cross",r="Christian Wisdom",n="Sacred wisdom from the Holy Bible";break;case"GURU_GRANTH_SAHIB":t="fas fa-khanda",r="Sikh Wisdom",n="Divine wisdom from the Guru Granth Sahib";break;case"TRIPITAKA":t="fas fa-dharmachakra",r="Buddhist Wisdom",n="Sacred guidance from the Tripitaka";break}o.className=t,i.textContent=r,f.textContent=n}I.addEventListener("submit",async e=>{e.preventDefault();const o=document.getElementById("userMessage").value.trim(),i=document.getElementById("selectedText").value;if(o.split(/\s+/).filter(t=>t.length>0).length<5){H("Please type more details. Share at least 5 words about your situation so I can provide meaningful guidance.");return}k.style.display="block",x.style.display="none",N.style.display="none",O.style.display="none";try{let t=P(i,o),r=!!t;if(t||(t=await j(o,i),L()),t&&t.quotes){const n=t.quotes.map(l=>l.source),v=["Bhagavad Gita 2:48","Bhagavad Gita 2:47","Bhagavad Gita 3:35","John 3:16","Psalm 23","Matthew 6:33","Quran 1:1","Quran 2:255","Quran 2:286","Guru Granth Sahib 1:1","Guru Granth Sahib 62:3","Rigveda 1:1:1","Atharvaveda 10:8:44"];n.filter(l=>v.some(d=>l.includes(d))).length>=2&&!r&&(E(),L(),t=await j(o,i))}Q(t,r)}catch(t){H(t.message)}finally{k.style.display="none"}});async function j(e,o){var _;const i=A[o]||s.userPrompts.allTexts,f={hi:"Hindi",es:"Spanish",fr:"French",de:"German",ar:"Arabic",bn:"Bengali",pa:"Punjabi",gu:"Gujarati",mr:"Marathi",te:"Telugu",ta:"Tamil",ur:"Urdu",pt:"Portuguese",it:"Italian",ja:"Japanese",ko:"Korean",ru:"Russian",tr:"Turkish",zh:"Chinese","zh-CN":"Chinese","zh-TW":"Chinese","zh-HK":"Chinese",nl:"Dutch",sv:"Swedish",da:"Danish",no:"Norwegian",fi:"Finnish",pl:"Polish",cs:"Czech",sk:"Slovak",hu:"Hungarian",ro:"Romanian",bg:"Bulgarian",hr:"Croatian",sr:"Serbian",sl:"Slovenian",et:"Estonian",lv:"Latvian",lt:"Lithuanian",mt:"Maltese",el:"Greek",he:"Hebrew",th:"Thai",vi:"Vietnamese",id:"Indonesian",ms:"Malay",fil:"Filipino",sw:"Swahili",am:"Amharic",ha:"Hausa",yo:"Yoruba",ig:"Igbo",ne:"Nepali",si:"Sinhala",my:"Burmese",km:"Khmer",lo:"Lao"},t=G(e),r=t.language,n=t.confidence;console.log("Language detection:",{detectedLanguage:r,confidence:n,userMessage:e});let v="CRITICAL: You MUST respond in ENGLISH ONLY. All quotes, context, and summary must be in English.";if(r!=="und"&&r!=="en"&&n>.3){const m=f[r];m&&(v=`CRITICAL: Respond in ${m} ONLY. The user wrote in ${m}, so provide your ENTIRE response (quotes, context, and summary) in ${m}. TRANSLATE THE QUOTES INTO ${m} - do not keep quotes in English.`)}console.log("Language instruction:",v);const S=`${i}

User's situation: ${e}`,l=await fetch(T.OPENAI_PROXY_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:[{role:"system",content:`${s.system.prompt}

${v}`},{role:"user",content:S}]})});if(!l.ok){const m=await l.json().catch(()=>({}));throw new Error(((_=m.error)==null?void 0:_.message)||s.errors.serviceUnavailable)}const d=V(await l.json());return d.quotes&&d.quotes.length>0&&d.quotes.every(m=>m.text&&m.source&&m.translation)&&d.summary&&h(e,o,d),d}function V(e){try{const o=e.choices[0].message.content,i=[],f=o.split(`
`);let t=null,r="";for(let n of f)n=n.trim(),n&&(n.startsWith("QUOTE:")?(t&&i.push(t),t={text:n.substring(6).trim(),source:"",translation:""}):n.startsWith("SOURCE:")&&t?t.source=n.substring(7).trim():n.startsWith("CONTEXT:")&&t?t.translation=n.substring(8).trim():n.startsWith("SUMMARY:")&&(r=n.substring(8).trim()));return t&&i.push(t),r||(r=s.fallbackSummaries.default),{quotes:i,summary:r}}catch(o){throw console.error("Error parsing response:",o),new Error(s.errors.noResponse)}}function Q(e,o=!1){W.innerHTML=e.quotes.map(i=>{const{source:f,text:t,translation:r}=i,{bookName:n,chapter:v,verse:S}=u(f);let l;n.toLowerCase().includes("guru granth sahib")||n.toLowerCase().includes("granth")?l=`Ang ${v}`:["rigveda","yajurveda","samaveda","atharvaveda"].includes(n.toLowerCase())?l=`${v}.${S}`:l=`${v}:${S}`;const d=c(n,l);return`
        <div class="quote-card">
          <div class="quote-text">${t}</div>
          <div class="quote-source">
            <i class="fas fa-book"></i>
            ${d?`<a href="${d}" target="_blank" rel="noopener noreferrer">${f}</a>`:f}
          </div>
          ${r?`
            <div class="quote-context">
              <span class="context-label">Context</span>
              <div class="context-text">${r}</div>
            </div>`:""}
        </div>
      `}).join(""),F.textContent=e.summary,N.style.display="block",O.style.display="block"}function H(e){x.textContent=e,x.style.display="block"}document.getElementById("userMessage").addEventListener("input",function(){this.style.height="auto",this.style.height=Math.min(this.scrollHeight,200)+"px"})});
