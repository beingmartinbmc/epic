const h="religious_guidance_cache";function p(t,o){const e=t.toLowerCase().split(/\s+/),n=o.toLowerCase().split(/\s+/),s=new Set(e),a=new Set(n),i=new Set([...s].filter(r=>a.has(r))),m=new Set([...s,...a]);return i.size/m.size}function c(){try{const t=localStorage.getItem(h);return t?JSON.parse(t):[]}catch(t){return console.warn("Error reading from cache:",t),[]}}function u(t){try{const o=t.sort((e,n)=>n.timestamp-e.timestamp).slice(0,50);localStorage.setItem(h,JSON.stringify(o))}catch(o){console.warn("Error saving to cache:",o)}}function g(t,o,e=.7){const n=c(),s=Date.now(),a=n.filter(r=>s-r.timestamp<864e5);a.length!==n.length&&u(a);let i=null,m=0;for(const r of a)if(r.selectedText===t){const l=p(r.userMessage,o);l>e&&l>m&&(m=l,i=r)}return i?i.response:null}function E(t,o,e){const n=c();n.push({selectedText:t,userMessage:o,response:e,timestamp:Date.now()}),u(n)}function w(){try{localStorage.removeItem(h)}catch(t){console.warn("Error clearing cache:",t)}}function C(){const t=c(),o=Date.now();return t.filter(e=>o-e.timestamp<864e5).sort((e,n)=>n.timestamp-e.timestamp).map(e=>({...e,formattedTime:new Date(e.timestamp).toLocaleString(),timeAgo:f(e.timestamp),isExpired:!1}))}function d(){const t=c(),o=Date.now();return t.filter(e=>o-e.timestamp>=864e5).sort((e,n)=>n.timestamp-e.timestamp).map(e=>({...e,formattedTime:new Date(e.timestamp).toLocaleString(),timeAgo:f(e.timestamp),isExpired:!0}))}function f(t){const e=Date.now()-t,n=Math.floor(e/(1e3*60)),s=Math.floor(e/(1e3*60*60)),a=Math.floor(e/(1e3*60*60*24));return a>0?`${a} day${a>1?"s":""} ago`:s>0?`${s} hour${s>1?"s":""} ago`:n>0?`${n} minute${n>1?"s":""} ago`:"Just now"}function S(){const t=c(),o=Date.now(),e=t.filter(s=>o-s.timestamp<864e5),n=t.filter(s=>o-s.timestamp>=864e5);return{totalEntries:t.length,validEntries:e.length,expiredEntries:n.length,oldestEntry:t.length>0?new Date(Math.min(...t.map(s=>s.timestamp))):null,newestEntry:t.length>0?new Date(Math.max(...t.map(s=>s.timestamp))):null,cacheSize:JSON.stringify(t).length}}export{E as cacheResponse,w as clearCache,g as findCachedResponse,C as getAllCacheEntries,S as getCacheStats,d as getExpiredCacheEntries};
