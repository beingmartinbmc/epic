(function(){const y=document.createElement("link").relList;if(y&&y.supports&&y.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))w(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&w(c)}).observe(document,{childList:!0,subtree:!0});function b(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function w(n){if(n.ep)return;n.ep=!0;const a=b(n);fetch(n.href,a)}})();const z="modulepreload",K=function(T,y){return new URL(T,y).href},H={},_=function(y,b,w){let n=Promise.resolve();if(b&&b.length>0){const c=document.getElementsByTagName("link"),u=document.querySelector("meta[property=csp-nonce]"),P=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));n=Promise.allSettled(b.map(d=>{if(d=K(d,w),d in H)return;H[d]=!0;const C=d.endsWith(".css"),B=C?'[rel="stylesheet"]':"";if(!!w)for(let A=c.length-1;A>=0;A--){const I=c[A];if(I.href===d&&(!C||I.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${d}"]${B}`))return;const p=document.createElement("link");if(p.rel=C?"stylesheet":z,C||(p.as="script"),p.crossOrigin="",p.href=d,P&&p.setAttribute("nonce",P),document.head.appendChild(p),C)return new Promise((A,I)=>{p.addEventListener("load",A),p.addEventListener("error",()=>I(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(c){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=c,window.dispatchEvent(u),!u.defaultPrevented)throw c}return n.then(c=>{for(const u of c||[])u.status==="rejected"&&a(u.reason);return y().catch(a)})};window.addEventListener("DOMContentLoaded",async()=>{const T={OPENAI_PROXY_URL:"https://religious-guide-hrv0qci1p-beingmartinbmcs-projects.vercel.app/api/openai-proxy"},y=await _(()=>import("./prompts-Bllmj0Gr.js"),[],import.meta.url),b=await _(()=>import("./utils-BIDl2gH2.js"),[],import.meta.url),w=await _(()=>import("./cache-COrhOpB8.js"),[],import.meta.url),n=y.default,{getReferenceUrl:a,parseSource:c}=b,{findCachedResponse:u,cacheResponse:P,clearCache:d,getCacheStats:C}=w;function B(e){if(!e||e.trim().length===0)return{language:"en",confidence:0};const o=e.toLowerCase();return/[\u0900-\u097F]/.test(e)?{language:"hi",confidence:.9}:/[\u0600-\u06FF]/.test(e)?{language:"ar",confidence:.9}:/[\u4E00-\u9FFF]/.test(e)?{language:"zh",confidence:.9}:/[\u3040-\u309F\u30A0-\u30FF]/.test(e)?{language:"ja",confidence:.9}:/[\uAC00-\uD7AF]/.test(e)?{language:"ko",confidence:.9}:/[\u0E00-\u0E7F]/.test(e)?{language:"th",confidence:.9}:/[\u0400-\u04FF]/.test(e)?{language:"ru",confidence:.9}:/[\u0370-\u03FF]/.test(e)?{language:"el",confidence:.9}:/[\u0590-\u05FF]/.test(e)?{language:"he",confidence:.9}:["hola","gracias","por favor","buenos días","buenas noches","adiós","sí","no","me","te","se","que","de","la","el","un","una","y","o","pero","como","cuando","donde","quien","que","cual","cuyo","cuyas","cuyos","cuyas"].filter(f=>new RegExp(`\\b${f}\\b`,"i").test(o)).length>=2?{language:"es",confidence:.8}:["bonjour","merci","s'il vous plaît","au revoir","oui","non","je","tu","il","elle","nous","vous","ils","elles","le","la","les","un","une","des","et","ou","mais","comme","quand","où","qui","que","quoi","dont","duquel","de laquelle"].filter(f=>new RegExp(`\\b${f}\\b`,"i").test(o)).length>=2?{language:"fr",confidence:.8}:["hallo","danke","bitte","auf wiedersehen","ja","nein","ich","du","er","sie","es","wir","ihr","sie","der","die","das","ein","eine","und","oder","aber","wie","wann","wo","wer","was","welcher","welche","welches"].filter(f=>new RegExp(`\\b${f}\\b`,"i").test(o)).length>=2?{language:"de",confidence:.8}:["ciao","grazie","prego","arrivederci","sì","no","io","tu","lui","lei","noi","voi","loro","il","la","lo","gli","le","un","una","e","o","ma","come","quando","dove","chi","che","cosa","quale"].filter(f=>new RegExp(`\\b${f}\\b`,"i").test(o)).length>=2?{language:"it",confidence:.8}:["olá","obrigado","por favor","adeus","sim","não","eu","tu","ele","ela","nós","vós","eles","elas","um","uma","e","ou","mas","como","quando","onde","quem","que","o que","qual"].filter(f=>new RegExp(`\\b${f}\\b`,"i").test(o)).length>=2?{language:"pt",confidence:.8}:["hallo","dank je","alsjeblieft","tot ziens","ja","nee","ik","jij","hij","zij","het","wij","jullie","zij","de","het","een","en","of","maar","hoe","wanneer","waar","wie","wat","welke"].filter(f=>new RegExp(`\\b${f}\\b`,"i").test(o)).length>=2?{language:"nl",confidence:.8}:{language:"en",confidence:.5}}const q={BHAGAVAD_GITA:"theme-hindu",VEDAS:"theme-hindu",QURAN:"theme-islamic",BIBLE:"theme-christian",GURU_GRANTH_SAHIB:"theme-sikh",TRIPITAKA:"theme-buddhist",ALL:"theme-universal"},p={BHAGAVAD_GITA:n.userPrompts.bhagavadGita,VEDAS:n.userPrompts.vedas,QURAN:n.userPrompts.quran,BIBLE:n.userPrompts.bible,GURU_GRANTH_SAHIB:n.userPrompts.guruGranthSahib,TRIPITAKA:n.userPrompts.tripitaka,ALL:n.userPrompts.allTexts},A=document.getElementById("guidanceForm"),I=document.getElementById("loadingSpinner"),x=document.getElementById("errorMessage"),k=document.getElementById("quotesSection"),W=document.getElementById("quotesGrid"),N=document.getElementById("summarySection"),F=document.getElementById("summaryText"),U=document.getElementById("selectedText"),O=document.querySelector(".divine-container"),E={count:document.getElementById("cacheCount"),validEntries:document.getElementById("validEntries"),latestCache:document.getElementById("latestCache"),clearBtn:document.getElementById("clearCacheBtn")};function L(){const e=C();E.count&&(E.count.textContent=e.validEntries),E.validEntries&&(E.validEntries.textContent=e.validEntries),E.latestCache&&(E.latestCache.textContent=e.newestEntry?new Date(e.newestEntry).toLocaleTimeString():"No entries")}L(),E.clearBtn&&E.clearBtn.addEventListener("click",e=>{e.stopPropagation(),d(),L()}),setInterval(L,6e4),U.addEventListener("change",e=>{Object.values(q).forEach(i=>O.classList.remove(i));const o=q[e.target.value]||"theme-universal";O.classList.add(o),D(e.target.value)});function D(e){const o=document.querySelector(".divine-title i"),i=document.querySelector(".divine-title span"),g=document.querySelector(".divine-subtitle");let t="fas fa-om",r="Divine Wisdom",s="Sacred guidance from ancient texts";switch(e){case"BHAGAVAD_GITA":t="fas fa-om",r="Hindu Wisdom",s="Sacred guidance from the Bhagavad Gita";break;case"VEDAS":t="fas fa-om",r="Hindu Wisdom",s="Sacred guidance from the Vedas";break;case"QURAN":t="fas fa-star-and-crescent",r="Islamic Guidance",s="Blessed guidance from the Holy Quran";break;case"BIBLE":t="fas fa-cross",r="Christian Wisdom",s="Sacred wisdom from the Holy Bible";break;case"GURU_GRANTH_SAHIB":t="fas fa-khanda",r="Sikh Wisdom",s="Divine wisdom from the Guru Granth Sahib";break;case"TRIPITAKA":t="fas fa-dharmachakra",r="Buddhist Wisdom",s="Sacred guidance from the Tripitaka";break}o.className=t,i.textContent=r,g.textContent=s}A.addEventListener("submit",async e=>{e.preventDefault();const o=document.getElementById("userMessage").value.trim(),i=document.getElementById("selectedText").value;if(o.split(/\s+/).filter(t=>t.length>0).length<5){j("Please type more details. Share at least 5 words about your situation so I can provide meaningful guidance.");return}I.style.display="block",x.style.display="none",k.style.display="none",N.style.display="none";try{let t=u(i,o),r=!!t;if(t||(t=await $(o,i),L()),t&&t.quotes){const s=t.quotes.map(l=>l.source),v=["Bhagavad Gita 2:48","Bhagavad Gita 2:47","Bhagavad Gita 3:35","John 3:16","Psalm 23","Matthew 6:33","Quran 1:1","Quran 2:255","Quran 2:286","Guru Granth Sahib 1:1","Guru Granth Sahib 62:3","Rigveda 1:1:1","Atharvaveda 10:8:44"];s.filter(l=>v.some(m=>l.includes(m))).length>=2&&!r&&(d(),L(),t=await $(o,i))}Q(t,r)}catch(t){j(t.message)}finally{I.style.display="none"}});async function $(e,o){var G;const i=p[o]||n.userPrompts.allTexts,g={hi:"Hindi",es:"Spanish",fr:"French",de:"German",ar:"Arabic",bn:"Bengali",pa:"Punjabi",gu:"Gujarati",mr:"Marathi",te:"Telugu",ta:"Tamil",ur:"Urdu",pt:"Portuguese",it:"Italian",ja:"Japanese",ko:"Korean",ru:"Russian",tr:"Turkish",zh:"Chinese","zh-CN":"Chinese","zh-TW":"Chinese","zh-HK":"Chinese",nl:"Dutch",sv:"Swedish",da:"Danish",no:"Norwegian",fi:"Finnish",pl:"Polish",cs:"Czech",sk:"Slovak",hu:"Hungarian",ro:"Romanian",bg:"Bulgarian",hr:"Croatian",sr:"Serbian",sl:"Slovenian",et:"Estonian",lv:"Latvian",lt:"Lithuanian",mt:"Maltese",el:"Greek",he:"Hebrew",th:"Thai",vi:"Vietnamese",id:"Indonesian",ms:"Malay",fil:"Filipino",sw:"Swahili",am:"Amharic",ha:"Hausa",yo:"Yoruba",ig:"Igbo",ne:"Nepali",si:"Sinhala",my:"Burmese",km:"Khmer",lo:"Lao"},t=B(e),r=t.language,s=t.confidence;console.log("Language detection:",{detectedLanguage:r,confidence:s,userMessage:e});let v="CRITICAL: You MUST respond in ENGLISH ONLY. All quotes, context, and summary must be in English.";if(r!=="und"&&r!=="en"&&s>.3){const h=g[r];h&&(v=`CRITICAL: Respond in ${h} ONLY. The user wrote in ${h}, so provide your ENTIRE response (quotes, context, and summary) in ${h}. TRANSLATE THE QUOTES INTO ${h} - do not keep quotes in English.`)}console.log("Language instruction:",v);const S=`${i}

User's situation: ${e}`,l=await fetch(T.OPENAI_PROXY_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:[{role:"system",content:`${n.system.prompt}

${v}`},{role:"user",content:S}]})});if(!l.ok){const h=await l.json().catch(()=>({}));throw new Error(((G=h.error)==null?void 0:G.message)||n.errors.serviceUnavailable)}const m=M(await l.json());return m.quotes&&m.quotes.length>0&&m.quotes.every(h=>h.text&&h.source&&h.translation)&&m.summary&&P(e,o,m),m}function M(e){try{const o=e.choices[0].message.content,i=[],g=o.split(`
`);let t=null,r="";for(let s of g)s=s.trim(),s&&(s.startsWith("QUOTE:")?(t&&i.push(t),t={text:s.substring(6).trim(),source:"",translation:""}):s.startsWith("SOURCE:")&&t?t.source=s.substring(7).trim():s.startsWith("CONTEXT:")&&t?t.translation=s.substring(8).trim():s.startsWith("SUMMARY:")&&(r=s.substring(8).trim()));return t&&i.push(t),r||(r=n.fallbackSummaries.default),{quotes:i,summary:r}}catch(o){throw console.error("Error parsing response:",o),new Error(n.errors.noResponse)}}function Q(e,o=!1){W.innerHTML=e.quotes.map(i=>{const{source:g,text:t,translation:r}=i,{bookName:s,chapter:v,verse:S}=c(g);let l;s.toLowerCase().includes("guru granth sahib")||s.toLowerCase().includes("granth")?l=`Ang ${v}`:["rigveda","yajurveda","samaveda","atharvaveda"].includes(s.toLowerCase())?l=`${v}.${S}`:l=`${v}:${S}`;const m=a(s,l);return`
        <div class="quote-card">
          <div class="quote-text">${t}</div>
          <div class="quote-source">
            <i class="fas fa-book"></i>
            ${m?`<a href="${m}" target="_blank" rel="noopener noreferrer">${g}</a>`:g}
          </div>
          ${r?`
            <div class="quote-context">
              <span class="context-label">Context</span>
              <div class="context-text">${r}</div>
            </div>`:""}
        </div>
      `}).join(""),F.textContent=e.summary,k.style.display="block",N.style.display="block"}function j(e){x.textContent=e,x.style.display="block"}document.getElementById("userMessage").addEventListener("input",function(){this.style.height="auto",this.style.height=Math.min(this.scrollHeight,200)+"px"})});
