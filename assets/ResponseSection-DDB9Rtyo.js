import{j as s}from"./index-D18hU00s.js";import{R as j,r as h}from"./react-vendor-cxkclgJA.js";import{p as N,g}from"./app-core-BbHgm4eB.js";import"./prompts-zDXgwyPh.js";const v=u=>{if(!u)return{quotes:[],summary:""};const o=[];let m="",n={};const p=u.split(`
`),x=p.length;for(let r=0;r<x;r++){const t=p[r].trim();if(t)if(t.startsWith("QUOTE:"))n.quote&&o.push({...n}),n={quote:t.substring(6).trim()};else if(t.startsWith("SOURCE:"))n.source=t.substring(7).trim();else if(t.startsWith("CONTEXT:"))n.context=t.substring(8).trim();else if(t.startsWith("SUMMARY:")){let l=t.substring(8).trim(),d=r+1;for(;d<x;){const e=p[d].trim();if(e&&(e.startsWith("QUOTE:")||e.startsWith("SOURCE:")||e.startsWith("CONTEXT:")))break;e&&(l+=" "+e),d++}m=l.trim(),r=d-1}else t.startsWith('"')&&t.endsWith('"')?(n.quote&&o.push({...n}),n={quote:t}):n.quote&&!n.source&&t.includes(":")?t.includes("Bhagavad Gita")||t.includes("Quran")||t.includes("Bible")||t.includes("Rigveda")||t.includes("Guru Granth Sahib")||t.includes("Tripitaka")?n.source=t:n.context=t:n.quote&&!n.context&&t.length>50&&(n.context=t)}if(n.quote&&o.push(n),o.length===0){const r=u.split(`

`),t=r.length;for(let l=0;l<t;l++){const e=r[l].split(`
`),i={};for(let a=0;a<e.length;a++){const c=e[a].trim();c.startsWith('"')&&c.endsWith('"')?i.quote=c:c.includes(":")?i.source=c:c.length>30&&(i.context=c)}i.quote&&o.push(i)}}return{quotes:o,summary:m}},b=j.memo(({response:u,isLoading:o})=>{const[m,n]=h.useState(new Set),[p,x]=h.useState(null),r=h.useMemo(()=>v(u),[u]),t=h.useMemo(()=>r.quotes.map(e=>{const{bookName:i,chapter:a,verse:c}=N(e.source||""),f=g(i,`${a}:${c}`);return{...e,parsedSource:i,chapter:a,verse:c,referenceUrl:f,isExpanded:m.has(e.quote)}}),[r.quotes,m]),l=h.useCallback(e=>{n(i=>{const a=new Set(i);return a.has(e)?a.delete(e):a.add(e),a})},[]),d=h.useCallback(async e=>{try{await navigator.clipboard.writeText(e),x(e),setTimeout(()=>x(null),2e3)}catch(i){console.error("Failed to copy quote:",i)}},[]);return h.useEffect(()=>{t.length>0&&m.size===0&&n(new Set([t[0].quote]))},[t.length,m.size]),o?s.jsx("div",{className:"response-section",children:s.jsxs("div",{className:"response-loading",children:[s.jsx("div",{className:"spinner-border text-primary",role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading guidance..."})}),s.jsx("p",{className:"mt-3",children:"Seeking divine wisdom..."})]})}):u?s.jsxs("div",{className:"response-section",children:[t.length>0&&s.jsxs("div",{className:"quotes-section",children:[s.jsx("h3",{className:"quotes-title",children:"Sacred Wisdom"}),t.map((e,i)=>s.jsx("div",{className:"quote-card",children:s.jsxs("div",{className:"quote-content",children:[s.jsxs("blockquote",{className:"quote-text",children:['"',e.quote,'"']}),s.jsxs("div",{className:"quote-meta",children:[s.jsx("span",{className:"quote-source",children:e.parsedSource}),e.chapter&&e.verse&&s.jsxs("span",{className:"quote-reference",children:[e.chapter,":",e.verse]}),e.referenceUrl&&s.jsx("a",{href:e.referenceUrl,target:"_blank",rel:"noopener noreferrer",className:"quote-link",title:"View Reference",children:s.jsx("i",{className:"fas fa-external-link-alt"})})]}),s.jsxs("div",{className:"quote-actions",children:[s.jsxs("button",{className:"btn btn-sm btn-outline-primary copy-btn",onClick:()=>d(e.quote),title:"Copy Quote",children:[s.jsx("i",{className:"fas fa-copy"}),p===e.quote?" Copied!":" Copy"]}),e.referenceUrl&&s.jsxs("button",{className:"btn btn-sm btn-outline-secondary reference-btn",onClick:()=>d(e.referenceUrl),title:"Copy Reference Link",children:[s.jsx("i",{className:"fas fa-link"}),p===e.referenceUrl?" Link Copied!":" Show Link"]})]}),e.context&&s.jsxs("div",{className:"quote-context",children:[s.jsxs("button",{className:"context-toggle",onClick:()=>l(e.quote),children:[e.isExpanded?"Hide Context":"Show Context",s.jsx("i",{className:`fas fa-chevron-${e.isExpanded?"up":"down"}`})]}),e.isExpanded&&s.jsx("div",{className:"context-content",children:e.context})]})]})},`${i}-${e.quote.substring(0,50)}`))]}),r.summary&&s.jsxs("div",{className:"summary-section",children:[s.jsx("h3",{className:"summary-title",children:"Guidance Summary"}),s.jsx("div",{className:"summary-content",children:r.summary})]})]}):s.jsx("div",{className:"response-section",children:s.jsxs("div",{className:"response-placeholder",children:[s.jsx("div",{className:"placeholder-icon",children:"üôè"}),s.jsx("h3",{children:"Seek Divine Guidance"}),s.jsx("p",{children:"Share your question or concern, and receive wisdom from sacred texts."})]})})});b.displayName="ResponseSection";export{b as default};
